var Core={source:null,loaded:false,spinner:null,websiteUrl:"//www.minecraft-plugins.com/",settings:{},init:function(){this.setSource();this.spinner=new Spinner;window.onload=function(){var params=Core.parseQueryString();if(params.search&&params.type){Core.search(params.search,params.type);$("#input-search-term").val(params.search);$("#input-server-type").val(params.type)}};$("#search-form").submit(function(){var search=$("#input-search-term").val(),type=$("#input-server-type :selected").attr("value");if(!search||!type){Core.error("Must not have empty parameters.");return false}});$("#input-server-type").change(function(){this.setSource()});this.source.populateSearchSuggestions()},parseQueryString:function(){var match,pl=/\+/g,search=/([^&=]+)=?([^&]*)/g,decode=function(s){return decodeURIComponent(s.replace(pl," "))},query=window.location.search.substring(1);var urlParams={};while(match=search.exec(query))urlParams[decode(match[1])]=decode(match[2]);return urlParams},setSource:function(src){var source=src||$("#input-server-type :selected").attr("value");switch(source){case"bukkit":this.source=DBO;break;default:this.source=null}return this.source},search:function(search,type){this.start();this.source.search(search,type)},clearData:function(){$("#plugin-name").empty();$("#plugin-author").empty();$("#plugin-latest-version").empty();$("#plugin-description").empty();$("#plugin-website").attr("href","#");$("#plugin-repo-page").attr("href","#");$("#plugin-latest-download").attr("href","#");$("#download-table > tbody").empty()},getSearchTerm:function(){return $("#input-search-term").val()},getServerType:function(){return $("#input-server-type :selected").val()},start:function(){Core.spinner.spin(document.getElementById("spinner"))},success:function(){this.loaded=true;this.spinner.stop();$(".plugin-details").fadeIn("slow")},error:function(msg){this.loaded=false;this.spinner.stop();$(".alert").slice(0).remove();$("<div>",{"class":"alert alert-danger",role:"alert",html:msg+'<a href="#" class="close" data-dismiss="alert">&times;</a>'}).appendTo("#error")},populateData:function(data){Core.source.data=data;$("#plugin-name").html(data.plugin_name||"");$("#plugin-author").html(data.authors||"");$("#plugin-latest-version").html(data.versions[0].version||"");$("#plugin-description").html(data.description||"");$("#plugin-website").attr("href",data.website||"");$("#plugin-repo-page").attr("href",data.dbo_page||"");$("#plugin-latest-download").attr("href",data.versions[0].download||"");$("#plugin-logo").attr("href",data.logo_full||"resources/images/default.jpg");$("#plugin-logo img").attr("src",data.logo_full||"resources/images/default.jpg");for(var i=0;i<data.versions.length;i++){var changelog_button=$("<a>",{"class":"btn btn-primary btn-sm btn-block btn-changelog",text:"Changelog"});var download_button=$("<a>",{href:data.versions[i].download,"class":"btn btn-primary btn-sm btn-block",html:"<i class='icon fa fa-download'></i>Download"});$("#download-table").find("tbody").append($("<tr id='trr-"+i+"'>").append($("<td>").text(data.versions[i].version)).append($("<td>").text(data.versions[i].filename)).append($("<td>").append(changelog_button)).append($("<td>").append(download_button)))}$(".btn-changelog").click(function(){var index=$(this).closest("td").parent()[0].sectionRowIndex;$("#changelog-title").text(Core.source.data.versions[index].version);$("#changelog-body").html(atob(Core.source.data.versions[index].changelog));$("#changelog-modal").modal("show")});Core.success()}};