var MinecraftPlugins={loaded:false,data:null,default_server_type:"bukkit",init:function(){MinecraftPlugins.populateSearchSuggestions(MinecraftPlugins.getServerType())},getPluginName:function(){return $("#input-plugin-name").val()},getServerType:function(){return $("#input-server-type :selected").val()},populateData:function(data){MinecraftPlugins.data=data;$("#plugin-name").html(data.plugin_name||"");$("#plugin-author").html(data.authors||"");$("#plugin-latest-version").html(data.versions[0].version||"");$("#plugin-description").html(data.description||"");$("#plugin-website").attr("href",data.website||"");$("#plugin-repo-page").attr("href",data.dbo_page||"");$("#plugin-latest-download").attr("href",data.versions[0].download||"");$("#plugin-logo").attr("href",data.logo_full||"resources/images/default.jpg");$("#plugin-logo img").attr("src",data.logo_full||"resources/images/default.jpg");for(var i=0;i<data.versions.length;i++){var changelog_button=$("<a>",{"class":"btn btn-primary btn-sm btn-block btn-changelog",text:"Changelog"});var download_button=$("<a>",{href:data.versions[i].download,"class":"btn btn-primary btn-sm btn-block",html:"<i class='icon fa fa-download'></i>Download"});$("#download-table").find("tbody").append($("<tr id='trr-"+i+"'>").append($("<td>").text(data.versions[i].version)).append($("<td>").text(data.versions[i].filename)).append($("<td>").append(changelog_button)).append($("<td>").append(download_button)))}$(".btn-changelog").click(function(){var index=$(this).closest("td").parent()[0].sectionRowIndex;$("#changelog-title").text(MinecraftPlugins.data.versions[index].version);$("#changelog-body").html(atob(MinecraftPlugins.data.versions[index].changelog));$("#changelog-modal").modal("show")});MinecraftPlugins.loadSuccess()},populateSearchSuggestions:function(server_type){var xhr=new XMLHttpRequest;xhr.onreadystatechange=function(){if(xhr.readyState===4&&xhr.status===200){var data=JSON.parse(xhr.responseText);$("#input-plugin-name").autocomplete({lookup:data.suggestions,lookupLimit:20,autoSelectFirst:true,onSearchComplete:function(query,suggestions){console.log("complete")},onSelect:function(suggestion){console.log(suggestion.value)}})}};xhr.open("GET",server_type+"-plugins.json",true);xhr.send()},startLoading:function(){$(".alert").slice(0).remove();if(MinecraftPlugins.loaded){$(".plugin-details").fadeOut("fast");MinecraftPlugins.clearData();MinecraftPlugins.data=null}MinecraftPlugins.spinner.spin(document.getElementById("spinner"))},loadSuccess:function(){MinecraftPlugins.loaded=true;MinecraftPlugins.spinner.stop();$(".plugin-details").fadeIn("fast")},loadError:function(msg){MinecraftPlugins.loaded=false;MinecraftPlugins.spinner.stop();$(".plugin-details").fadeOut("fast");var alert=$("<div>",{"class":"alert alert-danger",role:"alert",html:"<a href='#' class='close' data-dismiss='alert'>&times;</a>"+msg});$(".alert").slice(0).remove();$("#error").append(alert)}};